(()=>{var t={669:(t,e,r)=>{t.exports=r(609)},448:(t,e,r)=>{"use strict";var n=r(867),s=r(26),i=r(372),o=r(327),a=r(97),h=r(109),c=r(985),u=r(874),f=r(648),l=r(644),d=r(205);t.exports=function(t){return new Promise((function(e,r){var p,m=t.data,g=t.headers,E=t.responseType;function b(){t.cancelToken&&t.cancelToken.unsubscribe(p),t.signal&&t.signal.removeEventListener("abort",p)}n.isFormData(m)&&n.isStandardBrowserEnv()&&delete g["Content-Type"];var T=new XMLHttpRequest;if(t.auth){var v=t.auth.username||"",x=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";g.Authorization="Basic "+btoa(v+":"+x)}var A=a(t.baseURL,t.url);function R(){if(T){var n="getAllResponseHeaders"in T?h(T.getAllResponseHeaders()):null,i={data:E&&"text"!==E&&"json"!==E?T.response:T.responseText,status:T.status,statusText:T.statusText,headers:n,config:t,request:T};s((function(t){e(t),b()}),(function(t){r(t),b()}),i),T=null}}if(T.open(t.method.toUpperCase(),o(A,t.params,t.paramsSerializer),!0),T.timeout=t.timeout,"onloadend"in T?T.onloadend=R:T.onreadystatechange=function(){T&&4===T.readyState&&(0!==T.status||T.responseURL&&0===T.responseURL.indexOf("file:"))&&setTimeout(R)},T.onabort=function(){T&&(r(new f("Request aborted",f.ECONNABORTED,t,T)),T=null)},T.onerror=function(){r(new f("Network Error",f.ERR_NETWORK,t,T,T)),T=null},T.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",n=t.transitional||u;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(new f(e,n.clarifyTimeoutError?f.ETIMEDOUT:f.ECONNABORTED,t,T)),T=null},n.isStandardBrowserEnv()){var w=(t.withCredentials||c(A))&&t.xsrfCookieName?i.read(t.xsrfCookieName):void 0;w&&(g[t.xsrfHeaderName]=w)}"setRequestHeader"in T&&n.forEach(g,(function(t,e){void 0===m&&"content-type"===e.toLowerCase()?delete g[e]:T.setRequestHeader(e,t)})),n.isUndefined(t.withCredentials)||(T.withCredentials=!!t.withCredentials),E&&"json"!==E&&(T.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&T.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&T.upload&&T.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(p=function(t){T&&(r(!t||t&&t.type?new l:t),T.abort(),T=null)},t.cancelToken&&t.cancelToken.subscribe(p),t.signal&&(t.signal.aborted?p():t.signal.addEventListener("abort",p))),m||(m=null);var y=d(A);y&&-1===["http","https","file"].indexOf(y)?r(new f("Unsupported protocol "+y+":",f.ERR_BAD_REQUEST,t)):T.send(m)}))}},609:(t,e,r)=>{"use strict";var n=r(867),s=r(849),i=r(321),o=r(185),a=function t(e){var r=new i(e),a=s(i.prototype.request,r);return n.extend(a,i.prototype,r),n.extend(a,r),a.create=function(r){return t(o(e,r))},a}(r(546));a.Axios=i,a.CanceledError=r(644),a.CancelToken=r(972),a.isCancel=r(502),a.VERSION=r(288).version,a.toFormData=r(675),a.AxiosError=r(648),a.Cancel=a.CanceledError,a.all=function(t){return Promise.all(t)},a.spread=r(713),a.isAxiosError=r(268),t.exports=a,t.exports.default=a},972:(t,e,r)=>{"use strict";var n=r(644);function s(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var r=this;this.promise.then((function(t){if(r._listeners){var e,n=r._listeners.length;for(e=0;e<n;e++)r._listeners[e](t);r._listeners=null}})),this.promise.then=function(t){var e,n=new Promise((function(t){r.subscribe(t),e=t})).then(t);return n.cancel=function(){r.unsubscribe(e)},n},t((function(t){r.reason||(r.reason=new n(t),e(r.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},s.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},s.source=function(){var t;return{token:new s((function(e){t=e})),cancel:t}},t.exports=s},644:(t,e,r)=>{"use strict";var n=r(648);function s(t){n.call(this,null==t?"canceled":t,n.ERR_CANCELED),this.name="CanceledError"}r(867).inherits(s,n,{__CANCEL__:!0}),t.exports=s},502:t=>{"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},321:(t,e,r)=>{"use strict";var n=r(867),s=r(327),i=r(782),o=r(572),a=r(185),h=r(97),c=r(875),u=c.validators;function f(t){this.defaults=t,this.interceptors={request:new i,response:new i}}f.prototype.request=function(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var r=e.transitional;void 0!==r&&c.assertOptions(r,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var n=[],s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,h=[];if(this.interceptors.response.forEach((function(t){h.push(t.fulfilled,t.rejected)})),!s){var f=[o,void 0];for(Array.prototype.unshift.apply(f,n),f=f.concat(h),i=Promise.resolve(e);f.length;)i=i.then(f.shift(),f.shift());return i}for(var l=e;n.length;){var d=n.shift(),p=n.shift();try{l=d(l)}catch(t){p(t);break}}try{i=o(l)}catch(t){return Promise.reject(t)}for(;h.length;)i=i.then(h.shift(),h.shift());return i},f.prototype.getUri=function(t){t=a(this.defaults,t);var e=h(t.baseURL,t.url);return s(e,t.params,t.paramsSerializer)},n.forEach(["delete","get","head","options"],(function(t){f.prototype[t]=function(e,r){return this.request(a(r||{},{method:t,url:e,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(t){function e(e){return function(r,n,s){return this.request(a(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}f.prototype[t]=e(),f.prototype[t+"Form"]=e(!0)})),t.exports=f},648:(t,e,r)=>{"use strict";var n=r(867);function s(t,e,r,n,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s)}n.inherits(s,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var i=s.prototype,o={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(t){o[t]={value:t}})),Object.defineProperties(s,o),Object.defineProperty(i,"isAxiosError",{value:!0}),s.from=function(t,e,r,o,a,h){var c=Object.create(i);return n.toFlatObject(t,c,(function(t){return t!==Error.prototype})),s.call(c,t.message,e,r,o,a),c.name=t.name,h&&Object.assign(c,h),c},t.exports=s},782:(t,e,r)=>{"use strict";var n=r(867);function s(){this.handlers=[]}s.prototype.use=function(t,e,r){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},s.prototype.forEach=function(t){n.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=s},97:(t,e,r)=>{"use strict";var n=r(793),s=r(303);t.exports=function(t,e){return t&&!n(e)?s(t,e):e}},572:(t,e,r)=>{"use strict";var n=r(867),s=r(527),i=r(502),o=r(546),a=r(644);function h(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new a}t.exports=function(t){return h(t),t.headers=t.headers||{},t.data=s.call(t,t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||o.adapter)(t).then((function(e){return h(t),e.data=s.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return i(e)||(h(t),e&&e.response&&(e.response.data=s.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},185:(t,e,r)=>{"use strict";var n=r(867);t.exports=function(t,e){e=e||{};var r={};function s(t,e){return n.isPlainObject(t)&&n.isPlainObject(e)?n.merge(t,e):n.isPlainObject(e)?n.merge({},e):n.isArray(e)?e.slice():e}function i(r){return n.isUndefined(e[r])?n.isUndefined(t[r])?void 0:s(void 0,t[r]):s(t[r],e[r])}function o(t){if(!n.isUndefined(e[t]))return s(void 0,e[t])}function a(r){return n.isUndefined(e[r])?n.isUndefined(t[r])?void 0:s(void 0,t[r]):s(void 0,e[r])}function h(r){return r in e?s(t[r],e[r]):r in t?s(void 0,t[r]):void 0}var c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:h};return n.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=c[t]||i,s=e(t);n.isUndefined(s)&&e!==h||(r[t]=s)})),r}},26:(t,e,r)=>{"use strict";var n=r(648);t.exports=function(t,e,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?e(new n("Request failed with status code "+r.status,[n.ERR_BAD_REQUEST,n.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):t(r)}},527:(t,e,r)=>{"use strict";var n=r(867),s=r(546);t.exports=function(t,e,r){var i=this||s;return n.forEach(r,(function(r){t=r.call(i,t,e)})),t}},546:(t,e,r)=>{"use strict";var n=r(867),s=r(16),i=r(648),o=r(874),a=r(675),h={"Content-Type":"application/x-www-form-urlencoded"};function c(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u,f={transitional:o,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=r(448)),u),transformRequest:[function(t,e){if(s(e,"Accept"),s(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t))return t;if(n.isArrayBufferView(t))return t.buffer;if(n.isURLSearchParams(t))return c(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var r,i=n.isObject(t),o=e&&e["Content-Type"];if((r=n.isFileList(t))||i&&"multipart/form-data"===o){var h=this.env&&this.env.FormData;return a(r?{"files[]":t}:t,h&&new h)}return i||"application/json"===o?(c(e,"application/json"),function(t,e,r){if(n.isString(t))try{return(0,JSON.parse)(t),n.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||f.transitional,r=e&&e.silentJSONParsing,s=e&&e.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||s&&n.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(o){if("SyntaxError"===t.name)throw i.from(t,i.ERR_BAD_RESPONSE,this,null,this.response);throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:r(623)},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(t){f.headers[t]={}})),n.forEach(["post","put","patch"],(function(t){f.headers[t]=n.merge(h)})),t.exports=f},874:t=>{"use strict";t.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},288:t=>{t.exports={version:"0.27.2"}},849:t=>{"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},327:(t,e,r)=>{"use strict";var n=r(867);function s(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var o=[];n.forEach(e,(function(t,e){null!=t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,(function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),o.push(s(e)+"="+s(t))})))})),i=o.join("&")}if(i){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}},303:t=>{"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},372:(t,e,r)=>{"use strict";var n=r(867);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,s,i,o){var a=[];a.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},793:t=>{"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},268:(t,e,r)=>{"use strict";var n=r(867);t.exports=function(t){return n.isObject(t)&&!0===t.isAxiosError}},985:(t,e,r)=>{"use strict";var n=r(867);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=s(window.location.href),function(e){var r=n.isString(e)?s(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},16:(t,e,r)=>{"use strict";var n=r(867);t.exports=function(t,e){n.forEach(t,(function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])}))}},623:t=>{t.exports=null},109:(t,e,r)=>{"use strict";var n=r(867),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,i,o={};return t?(n.forEach(t.split("\n"),(function(t){if(i=t.indexOf(":"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(o[e]&&s.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([r]):o[e]?o[e]+", "+r:r}})),o):o}},205:t=>{"use strict";t.exports=function(t){var e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}},713:t=>{"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},675:(t,e,r)=>{"use strict";var n=r(867);t.exports=function(t,e){e=e||new FormData;var r=[];function s(t){return null===t?"":n.isDate(t)?t.toISOString():n.isArrayBuffer(t)||n.isTypedArray(t)?"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}return function t(i,o){if(n.isPlainObject(i)||n.isArray(i)){if(-1!==r.indexOf(i))throw Error("Circular reference detected in "+o);r.push(i),n.forEach(i,(function(r,i){if(!n.isUndefined(r)){var a,h=o?o+"."+i:i;if(r&&!o&&"object"==typeof r)if(n.endsWith(i,"{}"))r=JSON.stringify(r);else if(n.endsWith(i,"[]")&&(a=n.toArray(r)))return void a.forEach((function(t){!n.isUndefined(t)&&e.append(h,s(t))}));t(r,h)}})),r.pop()}else e.append(o,s(i))}(t),e}},875:(t,e,r)=>{"use strict";var n=r(288).version,s=r(648),i={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){i[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}}));var o={};i.transitional=function(t,e,r){function i(t,e){return"[Axios v"+n+"] Transitional option '"+t+"'"+e+(r?". "+r:"")}return function(r,n,a){if(!1===t)throw new s(i(n," has been removed"+(e?" in "+e:"")),s.ERR_DEPRECATED);return e&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(r,n,a)}},t.exports={assertOptions:function(t,e,r){if("object"!=typeof t)throw new s("options must be an object",s.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(t),i=n.length;i-- >0;){var o=n[i],a=e[o];if(a){var h=t[o],c=void 0===h||a(h,o,t);if(!0!==c)throw new s("option "+o+" must be "+c,s.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new s("Unknown option "+o,s.ERR_BAD_OPTION)}},validators:i}},867:(t,e,r)=>{"use strict";var n,s=r(849),i=Object.prototype.toString,o=(n=Object.create(null),function(t){var e=i.call(t);return n[e]||(n[e]=e.slice(8,-1).toLowerCase())});function a(t){return t=t.toLowerCase(),function(e){return o(e)===t}}function h(t){return Array.isArray(t)}function c(t){return void 0===t}var u=a("ArrayBuffer");function f(t){return null!==t&&"object"==typeof t}function l(t){if("object"!==o(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}var d=a("Date"),p=a("File"),m=a("Blob"),g=a("FileList");function E(t){return"[object Function]"===i.call(t)}var b=a("URLSearchParams");function T(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),h(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}var v,x=(v="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(t){return v&&t instanceof v});t.exports={isArray:h,isArrayBuffer:u,isBuffer:function(t){return null!==t&&!c(t)&&null!==t.constructor&&!c(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){var e="[object FormData]";return t&&("function"==typeof FormData&&t instanceof FormData||i.call(t)===e||E(t.toString)&&t.toString()===e)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&u(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:f,isPlainObject:l,isUndefined:c,isDate:d,isFile:p,isBlob:m,isFunction:E,isStream:function(t){return f(t)&&E(t.pipe)},isURLSearchParams:b,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:T,merge:function t(){var e={};function r(r,n){l(e[n])&&l(r)?e[n]=t(e[n],r):l(r)?e[n]=t({},r):h(r)?e[n]=r.slice():e[n]=r}for(var n=0,s=arguments.length;n<s;n++)T(arguments[n],r);return e},extend:function(t,e,r){return T(e,(function(e,n){t[n]=r&&"function"==typeof e?s(e,r):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t},inherits:function(t,e,r,n){t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,r&&Object.assign(t.prototype,r)},toFlatObject:function(t,e,r){var n,s,i,o={};e=e||{};do{for(s=(n=Object.getOwnPropertyNames(t)).length;s-- >0;)o[i=n[s]]||(e[i]=t[i],o[i]=!0);t=Object.getPrototypeOf(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},kindOf:o,kindOfTest:a,endsWith:function(t,e,r){t=String(t),(void 0===r||r>t.length)&&(r=t.length),r-=e.length;var n=t.indexOf(e,r);return-1!==n&&n===r},toArray:function(t){if(!t)return null;var e=t.length;if(c(e))return null;for(var r=new Array(e);e-- >0;)r[e]=t[e];return r},isTypedArray:x,isFileList:g}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=1e-6;function e(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5],h=e[6],c=e[7],u=e[8],f=e[9],l=e[10],d=e[11],p=e[12],m=e[13],g=e[14],E=e[15],b=r*a-n*o,T=r*h-s*o,v=r*c-i*o,x=n*h-s*a,A=n*c-i*a,R=s*c-i*h,w=u*m-f*p,y=u*g-l*p,_=u*E-d*p,F=f*g-l*m,S=f*E-d*m,U=l*E-d*g,P=b*U-T*S+v*F+x*_-A*y+R*w;return P?(P=1/P,t[0]=(a*U-h*S+c*F)*P,t[1]=(s*S-n*U-i*F)*P,t[2]=(m*R-g*A+E*x)*P,t[3]=(l*A-f*R-d*x)*P,t[4]=(h*_-o*U-c*y)*P,t[5]=(r*U-s*_+i*y)*P,t[6]=(g*v-p*R-E*T)*P,t[7]=(u*R-l*v+d*T)*P,t[8]=(o*S-a*_+c*w)*P,t[9]=(n*_-r*S-i*w)*P,t[10]=(p*A-m*v+E*b)*P,t[11]=(f*v-u*A-d*b)*P,t[12]=(a*y-o*F-h*w)*P,t[13]=(r*F-n*y+s*w)*P,t[14]=(m*T-p*x-g*b)*P,t[15]=(u*x-f*T+l*b)*P,t):null}function i(e,r,n,s){var i,o,a,h,c,u,f,l,d,p,m,g,E,b,T,v,x,A,R,w,y,_,F,S,U=s[0],P=s[1],B=s[2],C=Math.sqrt(U*U+P*P+B*B);return Math.abs(C)<t?null:(U*=C=1/C,P*=C,B*=C,i=Math.sin(n),a=1-(o=Math.cos(n)),h=r[0],c=r[1],u=r[2],f=r[3],l=r[4],d=r[5],p=r[6],m=r[7],g=r[8],E=r[9],b=r[10],T=r[11],v=U*U*a+o,x=P*U*a+B*i,A=B*U*a-P*i,R=U*P*a-B*i,w=P*P*a+o,y=B*P*a+U*i,_=U*B*a+P*i,F=P*B*a-U*i,S=B*B*a+o,e[0]=h*v+l*x+g*A,e[1]=c*v+d*x+E*A,e[2]=u*v+p*x+b*A,e[3]=f*v+m*x+T*A,e[4]=h*R+l*w+g*y,e[5]=c*R+d*w+E*y,e[6]=u*R+p*w+b*y,e[7]=f*R+m*w+T*y,e[8]=h*_+l*F+g*S,e[9]=c*_+d*F+E*S,e[10]=u*_+p*F+b*S,e[11]=f*_+m*F+T*S,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function o(t,e,r,n,s,i,o){var a=1/(e-r),h=1/(n-s),c=1/(i-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(s+n)*h,t[14]=(o+i)*c,t[15]=1,t}function a(e,r,s,i){var o,a,h,c,u,f,l,d,p,m,g=r[0],E=r[1],b=r[2],T=i[0],v=i[1],x=i[2],A=s[0],R=s[1],w=s[2];return Math.abs(g-A)<t&&Math.abs(E-R)<t&&Math.abs(b-w)<t?n(e):(l=g-A,d=E-R,p=b-w,o=v*(p*=m=1/Math.sqrt(l*l+d*d+p*p))-x*(d*=m),a=x*(l*=m)-T*p,h=T*d-v*l,(m=Math.sqrt(o*o+a*a+h*h))?(o*=m=1/m,a*=m,h*=m):(o=0,a=0,h=0),c=d*h-p*a,u=p*o-l*h,f=l*a-d*o,(m=Math.sqrt(c*c+u*u+f*f))?(c*=m=1/m,u*=m,f*=m):(c=0,u=0,f=0),e[0]=o,e[1]=c,e[2]=l,e[3]=0,e[4]=a,e[5]=u,e[6]=d,e[7]=0,e[8]=h,e[9]=f,e[10]=p,e[11]=0,e[12]=-(o*g+a*E+h*b),e[13]=-(c*g+u*E+f*b),e[14]=-(l*g+d*E+p*b),e[15]=1,e)}function h(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}function c(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function u(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function f(t,e,r){var n=e[0],s=e[1],i=e[2],o=r[0],a=r[1],h=r[2];return t[0]=s*h-i*a,t[1]=i*o-n*h,t[2]=n*a-s*o,t}function l(t,e,r){var n=e[0],s=e[1],i=e[2],o=r[3]*n+r[7]*s+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*s+r[8]*i+r[12])/o,t[1]=(r[1]*n+r[5]*s+r[9]*i+r[13])/o,t[2]=(r[2]*n+r[6]*s+r[10]*i+r[14])/o,t}Math.PI;class d{constructor(){this.roleStep=.05,this.camPitch=0,this.camYaw=0,this.winWidth=window.innerWidth,this.winHeight=window.innerHeight,this.winCenterX=window.innerWidth/2,this.winCenterY=window.innerHeight/2,this.camPos=h(),this.camFront=h(),this.camUp=h(),this.camLookAt=e(),this.camLookAtCenter=h(),this.camPos[0]=0,this.camPos[1]=0,this.camPos[2]=10,this.camFront[0]=0,this.camFront[1]=0,this.camFront[2]=-1,this.camUp[0]=0,this.camUp[1]=1,this.camUp[2]=0,u(this.camLookAtCenter,this.camFront,this.camPos),a(this.camLookAt,this.camPos,this.camLookAtCenter,this.camUp)}getViewportOrtho(){const t=e();return o(t,-1,1,-1,1,0,100),t}getShadowOrtho(){const t=e();return o(t,-15,15,-15,15,0,100),t}getPerspective(){const t=.25*Math.PI,r=1*window.innerWidth/window.innerHeight,n=e();return function(t,e,r,n,s){var i=1/Math.tan(e/2),o=1/-99.99;t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=100.01*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o,t[15]=0}(n,t,r),n}getCamPosArray(){return[this.camPos[0],this.camPos[1],this.camPos[2]]}getCamFrontArray(){return[this.camFront[0],this.camFront[1],this.camFront[2]]}getLookAt(){return this.camLookAt}getLookAt3(){const t=e();var r,n;return r=t,n=this.camLookAt,r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}movePos(t,e,r){this.camPos[0]+=t,this.camPos[1]+=e,this.camPos[2]+=r,u(this.camLookAtCenter,this.camFront,this.camPos),a(this.camLookAt,this.camPos,this.camLookAtCenter,this.camUp)}registerInteractionEvent(){window.addEventListener("mousemove",(t=>{let e=t.x,r=t.y;var n,s,i,o,a,h;this.camPitch=3.1415926*(-r/this.winHeight+.5),this.camYaw=3.1415926*(e/this.winWidth+1),this.camFront[0]=Math.cos(this.camPitch)*Math.cos(this.camYaw),this.camFront[1]=Math.sin(this.camPitch),this.camFront[2]=Math.cos(this.camPitch)*Math.sin(this.camYaw),n=this.camFront,s=this.camFront,i=s[0],o=s[1],a=s[2],(h=i*i+o*o+a*a)>0&&(h=1/Math.sqrt(h),n[0]=s[0]*h,n[1]=s[1]*h,n[2]=s[2]*h),this.movePos(0,0,0)})),window.addEventListener("keydown",(t=>{if("d"==t.key.toLowerCase()){let t=h();f(t,this.camFront,this.camUp),this.movePos(t[0]*this.roleStep,t[1]*this.roleStep,t[2]*this.roleStep)}if("a"==t.key.toLowerCase()){let t=h();f(t,this.camFront,this.camUp),this.movePos(-t[0]*this.roleStep,-t[1]*this.roleStep,-t[2]*this.roleStep)}"w"==t.key.toLowerCase()&&this.movePos(this.camFront[0]*this.roleStep,this.camFront[1]*this.roleStep,this.camFront[2]*this.roleStep),"s"==t.key.toLowerCase()&&this.movePos(-this.camFront[0]*this.roleStep,-this.camFront[1]*this.roleStep,-this.camFront[2]*this.roleStep),"q"==t.key.toLowerCase()&&this.movePos(this.camUp[0]*this.roleStep,this.camUp[1]*this.roleStep,this.camUp[2]*this.roleStep),"e"==t.key.toLowerCase()&&this.movePos(-this.camUp[0]*this.roleStep,-this.camUp[1]*this.roleStep,-this.camUp[2]*this.roleStep)}))}}class p{constructor(){this.enableHdr=!1,this.depthMap=!1,this.scaler=1}static create(){return new p}setHdr(t){return this.enableHdr=t,this}setDepthMap(t){return this.enableHdr=t,this}setScaler(t){return this.scaler=t,this}}class m{constructor(t,e){this.options=e||new p,this.gl=t,this.fb=t.createFramebuffer(),this.tex=t.createTexture(),t.bindFramebuffer(t.FRAMEBUFFER,this.fb),t.bindTexture(t.TEXTURE_2D,this.tex),this.options.enableHdr?t.texImage2D(t.TEXTURE_2D,0,t.RGBA16F,window.innerWidth*this.options.scaler,window.innerHeight*this.options.scaler,0,t.RGBA,t.FLOAT,null):this.options.depthMap?t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT,1024,1024,0,t.DEPTH_COMPONENT,t.FLOAT,null):t.texImage2D(t.TEXTURE_2D,0,t.RGB,window.innerWidth*this.options.scaler,window.innerHeight*this.options.scaler,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),this.options.depthMap?t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.tex,0):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.tex,0),this.rbo=t.createRenderbuffer(),this.options.depthMap?t.readBuffer(t.NONE):(t.bindRenderbuffer(t.RENDERBUFFER,this.rbo),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH24_STENCIL8,window.innerWidth*this.options.scaler,window.innerHeight*this.options.scaler),t.bindRenderbuffer(t.RENDERBUFFER,null),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.rbo)),t.bindFramebuffer(t.FRAMEBUFFER,null)}bind(){this.options.depthMap?this.gl.viewport(0,0,1024,1024):this.gl.viewport(0,0,window.innerWidth*this.options.scaler,window.innerHeight*this.options.scaler),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fb)}unbind(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}}var g=r(669),E=r.n(g),b=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function o(t){try{h(n.next(t))}catch(t){i(t)}}function a(t){try{h(n.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))};function T(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert("Shader error:"+t.getShaderInfoLog(n)),console.log("Cannot Compile Shader"),console.log(r),t.deleteShader(n),null)}function v(t){return b(this,void 0,void 0,(function*(){const e=new Image;return yield new Promise(((r,n)=>{e.onload=()=>{r(!0)},e.src=t})),e}))}function x(t){return b(this,void 0,void 0,(function*(){return(yield E().get(t)).data}))}class A{constructor(){this.mapping=new Map,this.numVertices=0}set(t,e){this.mapping.set(t,e)}get(t){const e=this.mapping.get(t);if(void 0===e)throw new Error("Key missing");return e}exists(t){return this.mapping.has(t)}setNumVertices(t){this.numVertices=t}getNumVertices(){return this.numVertices}}class R{constructor(t){this.gl=t,this.texList=[],this.cubeTex=t.createTexture(),this.buf=new A,this.vao=t.createVertexArray()}initBuffer(){const t=this.gl,e=t.createBuffer();t.bindVertexArray(this.vao),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,1,1,1,1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,1,-1,1,1,1,1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,1,-1,1]),t.STATIC_DRAW),t.bindVertexArray(null),this.buf.set("pos",e)}loadTexFromFolder(t){return e=this,r=void 0,s=function*(){const e=["right","left","top","bottom","front","back"],r=this.gl;r.bindTexture(r.TEXTURE_CUBE_MAP,this.cubeTex);for(let n=0;n<e.length;n++){const s=yield v(t+"/"+e[n]+".jpg");r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,r.RGB,s.width,s.height,0,r.RGB,r.UNSIGNED_BYTE,s)}r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_R,r.CLAMP_TO_EDGE)},new((n=void 0)||(n=Promise))((function(t,i){function o(t){try{h(s.next(t))}catch(t){i(t)}}function a(t){try{h(s.throw(t))}catch(t){i(t)}}function h(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(t){t(r)}))).then(o,a)}h((s=s.apply(e,r||[])).next())}));var e,r,n,s}draw(t,e){const r=this.gl;r.disable(r.STENCIL_TEST),r.depthMask(!1);const n=e.getPerspective(),s=e.getLookAt3();r.bindVertexArray(this.vao),r.bindBuffer(r.ARRAY_BUFFER,this.buf.get("pos")),r.vertexAttribPointer(t.getAttr("aPos"),3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(t.getAttr("aPos")),t.use(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_CUBE_MAP,this.cubeTex),r.uniform1i(t.getUniform("uSkybox"),0),r.uniformMatrix4fv(t.getUniform("uProj"),!1,n),r.uniformMatrix4fv(t.getUniform("uView"),!1,s),r.drawArrays(r.TRIANGLES,0,36),r.bindVertexArray(null),r.depthMask(!0),r.enable(r.STENCIL_TEST)}}class w{constructor(){this.loader=document.createElement("div");const t=this.loader;t.id="aria-loader",t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.style.backgroundColor="#000000",t.style.color="#ffffff",t.innerHTML="Loading...",document.getElementsByTagName("body")[0].appendChild(t)}static getInstance(){return null==this.instance&&(this.instance=new w),this.instance}updateLoadingTip(t){this.loader.innerHTML="Loading... "+t}done(){this.loader.style.display="none"}}class y{constructor(t,e,r){""==e||""==r?(this.enabled=!1,this.shaderProgram=t.createProgram()):(this.enabled=!0,this.shaderProgram=function(t,e,r){const n=T(t,t.VERTEX_SHADER,e),s=T(t,t.FRAGMENT_SHADER,r);if(null==n||null==s)return null;{const e=n,r=s,i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?i:(alert("ShaderProg error:"+t.getProgramInfoLog(i)),null)}}(t,e,r)),this.gl=t}getAttr(t){if(!this.enabled)throw new Error("Shader is invalid");return this.gl.getAttribLocation(this.shaderProgram,t)}getUniform(t){if(!this.enabled)throw new Error("Shader is invalid");return this.gl.getUniformLocation(this.shaderProgram,t)}use(){if(!this.enabled)throw new Error("Shader is invalid");this.gl.useProgram(this.shaderProgram)}}class _{constructor(){this.mapping=new Map,this.numVertices=0}set(t,e){this.mapping.set(t,e)}get(t){const e=this.mapping.get(t);if(void 0===e)throw new Error("Key missing");return e}setNumVertices(t){this.numVertices=t}getNumVertices(){return this.numVertices}}var F,S=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function o(t){try{h(n.next(t))}catch(t){i(t)}}function a(t){try{h(n.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))};class U{constructor(t){this.gl=t,this.components=new Map,this.attributes=new Map,this.parent=null}static create(t){return new this(t)}register(){throw new Error("Component cannot be registered")}respond(t,e){throw new Error("Component cannot respond")}addComponent(t,e){return this.components.set(t,e),e.parent=this,e.register(),this}childExist(t){return this.components.has(t)}signal(t,e,...r){var n;return null===(n=this.components.get(t))||void 0===n?void 0:n.respond(e,r)}setAttr(t,e){return this.attributes.set(t,e),this}getAttr(t){return this.attributes.get(t)}getChild(t){return this.components.get(t)}}!function(t){t.acmtDiffuse="texDiffuse",t.acmtSpecular="texSpecular"}(F||(F={}));class P extends U{constructor(t){super(t),this.camera=new d,this.shader=new y(t,"",""),this.depthShader=new y(t,"",""),this.texUniformMaps=[{k:F.acmtDiffuse,u:"uDiffuse"},{k:F.acmtSpecular,u:"uSpecular"}],this.texUniformOrds=[t.TEXTURE0,t.TEXTURE1]}renderLightDepthMapS(t){this.renderLightDepthMap(this.getChild("light"),t)}renderLightDepthMap(t,e){if(0==this.childExist("light"))throw new Error("Light does not exist");const r=this.camera,n=this.shader,s=new d;this.camera=s,this.shader=this.depthShader,s.camFront=new Float32Array(t.lightPos[e]),s.camPos=new Float32Array([0,9,0]),0==s.camFront[0]&&0==s.camFront[2]&&(s.camUp=new Float32Array([0,0,1])),s.movePos(0,0,0),this.render(),this.camera=r,this.shader=n}setCamera(t){return this.camera=t,this}setShader(t){return this.shader=t,this}setDepthShader(t){return this.depthShader=t,this}setBuffer(t){return this.addComponent("buffer",t),this}setTexture(t,e){return this.addComponent(t,e),this}setMaterial(t){return this.addComponent("material",t),this}setLight(t){return this.addComponent("light",t),this}render(){const t=this.gl,r=this.camera.getLookAt(),n=this.camera.getPerspective(),i=this.camera.getViewportOrtho(),o=this.camera.getShadowOrtho(),a=this.getChild("buffer"),h=e(),c=e();s(h,r),function(t,e){if(t===e){var r=e[1],n=e[2],s=e[3],i=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(c,h),this.shader.use(),t.bindBuffer(t.ARRAY_BUFFER,a.getBuffer().get("pos")),t.vertexAttribPointer(this.shader.getAttr("aVert"),3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.shader.getAttr("aVert")),a.getBuffer().exists("tex")&&(t.bindBuffer(t.ARRAY_BUFFER,a.getBuffer().get("tex")),t.vertexAttribPointer(this.shader.getAttr("aTex"),2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.shader.getAttr("aTex"))),a.getBuffer().exists("norm")&&(t.bindBuffer(t.ARRAY_BUFFER,a.getBuffer().get("norm")),t.vertexAttribPointer(this.shader.getAttr("aNorm"),3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.shader.getAttr("aNorm"))),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.getBuffer().get("ele")),t.uniformMatrix4fv(this.shader.getUniform("uModel"),!1,r),t.uniformMatrix4fv(this.shader.getUniform("uProj"),!1,n),t.uniformMatrix4fv(this.shader.getUniform("uViewOrtho"),!1,i),t.uniformMatrix4fv(this.shader.getUniform("uShadowOrtho"),!1,o),t.uniformMatrix4fv(this.shader.getUniform("uModelIT"),!1,c),t.uniform3fv(this.shader.getUniform("uCamPos"),this.camera.getCamPosArray()),t.uniform3fv(this.shader.getUniform("uCamFront"),this.camera.getCamFrontArray()),t.uniform1f(this.shader.getUniform("uScrWidth"),window.innerWidth),t.uniform1f(this.shader.getUniform("uScrHeight"),window.innerHeight);for(let e=0;e<this.texUniformMaps.length;e++)this.childExist(this.texUniformMaps[e].k)&&(t.activeTexture(this.texUniformOrds[e]),t.bindTexture(t.TEXTURE_2D,this.getChild(this.texUniformMaps[e].k).getTex()),t.uniform1i(this.shader.getUniform(this.texUniformMaps[e].u),e));this.childExist("material")&&this.getChild("material").emitUniforms(this.shader),this.childExist("light")&&this.getChild("light").emitUniforms(this.shader),t.drawElements(t.TRIANGLES,a.getBuffer().numVertices,t.UNSIGNED_SHORT,0)}}class B extends U{constructor(t){super(t),this.setAttr("buffer_map",new A)}register(){}respond(t,e){const r=this.getAttr("buffer_map");"add"==t&&r.set(e[0],e[1])}getBuffer(){return this.getAttr("buffer_map")}addGeometry(t){return this.addComponent("geometry",t),this}}class C extends U{constructor(t){super(t),this.cx=0,this.cy=0,this.cz=0,this.sc=0,this.rot=e(),n(this.rot),this.rotinv=e(),n(this.rotinv)}translate(t,e,r){return this.cx=t,this.cy=e,this.cz=r,this}scale(t){return this.sc=t,this}rotateX(t){return i(this.rot,this.rot,t,new Float32Array([1,0,0])),s(this.rotinv,this.rot),this}rotateY(t){return i(this.rot,this.rot,t,new Float32Array([0,1,0])),s(this.rotinv,this.rot),this}rotateZ(t){return i(this.rot,this.rot,t,new Float32Array([0,0,1])),s(this.rotinv,this.rot),this}register(){if(!(this.parent instanceof B))throw new Error("Parent should be AriaComBuffers");{const t=this.parent,e=this.gl,r=e.createBuffer();let n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];for(let t=0;t<n.length;t+=3){let e=h();c(e,n[t],n[t+1],n[t+2]),l(e,e,this.rot),n[t]=e[0]*this.sc+this.cx,n[t+1]=e[1]*this.sc+this.cy,n[t+2]=e[2]*this.sc+this.cz}e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),t.getBuffer().set("pos",r);const s=e.createBuffer();let i=[0,0,1,0,1,1,0,1],o=[];for(let t=0;t<6;t++)o=o.concat(i);e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),t.getBuffer().set("tex",s);const a=e.createBuffer();let u=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],f=[];for(let t=0;t<6;t++)for(let e=0;e<4;e++){let e=h(),r=h();c(r,u[t][0],u[t][1],u[t][2]),l(e,r,this.rot),console.log(this.rotinv),f=f.concat([e[0],e[1],e[2]])}e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW),t.getBuffer().set("norm",a);const d=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,d);const p=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(p),e.STATIC_DRAW),t.getBuffer().set("ele",d),t.getBuffer().setNumVertices(36)}}}class O extends U{constructor(t){super(t),this.containers=[]}renderLightDepthMap(t,e){throw new Error("Method not implemented.")}renderLightDepthMapS(t){this.containers.forEach((e=>{e.renderLightDepthMapS(t)}))}addObject(t){this.containers.push(t)}render(){this.containers.forEach((t=>{t.render()}))}}class L extends O{}class D extends U{constructor(t){super(t),this.tex=t.createTexture()}setTex(t){return this.tex=t,this}getTex(){return this.tex}register(){}}class M extends U{constructor(t){super(t),this.cx=0,this.cy=0,this.cz=0,this.sc=0,this.rot=e(),n(this.rot)}register(){if(!(this.parent instanceof B))throw new Error("Parent should be AriaComBuffers");{const t=this.parent,e=this.gl,r=e.createBuffer();let n=[-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1];e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW);const s=e.createBuffer();let i=[0,0,1,0,1,1,0,1];e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW);const o=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o);const a=[0,1,2,0,2,3];e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),e.STATIC_DRAW),t.getBuffer().set("pos",r),e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),t.getBuffer().set("tex",s),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),e.STATIC_DRAW),t.getBuffer().set("ele",o),t.getBuffer().setNumVertices(6)}}}class N extends U{constructor(t){super(t),this.gl=t,this.lightPos=[],this.lightColor=[],this.lightType=[],this.lightCam=[]}register(){}addPointLight(t,e){this.lightPos.push(t),this.lightColor.push(e),this.lightType.push(0);const r=new d;return this.lightCam.push(r),this}addDirectionalLight(t,e){this.lightPos.push(t),this.lightColor.push(e),this.lightType.push(1);const r=new d;return r.camFront=new Float32Array(t),r.camPos=new Float32Array([0,9,0]),0==r.camFront[0]&&0==r.camFront[2]&&(r.camUp=new Float32Array([0,0,1])),r.movePos(0,0,0),this.lightCam.push(r),this}emitUniforms(t){const e=this.gl;for(let r=0;r<this.lightPos.length;r++)e.uniform3f(t.getUniform("uLightPos["+r+"]"),this.lightPos[r][0],this.lightPos[r][1],this.lightPos[r][2]),e.uniform3f(t.getUniform("uLightColor["+r+"]"),this.lightColor[r][0],this.lightColor[r][1],this.lightColor[r][2]),e.uniform1i(t.getUniform("uLightType["+r+"]"),this.lightType[r]),e.uniformMatrix4fv(t.getUniform("uLightModel["+r+"]"),!1,this.lightCam[r].camLookAt)}}class I extends U{constructor(t){super(t),this.gl=t,this.albedo=[0,0,0],this.roughness=0,this.metallic=1,this.ao=0}register(){}setAlbedo(t,e,r){return this.albedo[0]=t,this.albedo[1]=e,this.albedo[2]=r,this}setRoughness(t){return this.roughness=t,this}setMetallic(t){return this.metallic=t,this}setAO(t){return this.ao=t,this}emitUniforms(t){const e=this.gl;e.uniform3f(t.getUniform("uS_Albedo"),this.albedo[0],this.albedo[1],this.albedo[2]),e.uniform1f(t.getUniform("uS_Roughness"),this.roughness),e.uniform1f(t.getUniform("uS_Metallic"),this.metallic),e.uniform1f(t.getUniform("uS_AO"),this.ao)}}function j(t){t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}!function(){var t,e,r,n;t=this,e=void 0,n=function*(){w.getInstance().updateLoadingTip("Initializing");const t=new d,e=document.getElementById("webgl_displayer");e.width=window.innerWidth,e.height=window.innerHeight;const r=e.getContext("webgl2",{stencil:!0}),n=yield class{constructor(t){this.gl=t,this.shaders=new Map,this.textures=new _}static getInstance(t){return S(this,void 0,void 0,(function*(){return null==this.instance&&(this.instance=new this(t),yield this.instance.load()),this.instance}))}getTexStruct(){return this.textures}addTexture(t,e){this.textures.set(t,e)}getTexture(t){return null==this.textures.get(t)&&window.alert("No element:"+t),this.textures.get(t)}getShader(t){return null==this.shaders.get(t)&&window.alert("No element:"+t),this.shaders.get(t)}load(){return S(this,void 0,void 0,(function*(){const t=this.gl,e=t=>{t||window.alert("Error occurred during loading procedure")},r=(e,r,n)=>S(this,void 0,void 0,(function*(){try{const s=(e,r)=>S(this,void 0,void 0,(function*(){const n=yield x(e),s=yield x(r);return new y(t,n,s)}));return((t,e)=>{this.shaders.set(t,e)})(e,yield s(r,n)),!0}catch(t){return!1}})),n=[{name:"hdrShader",v:"./shaders/hdr/vertex.glsl",f:"./shaders/hdr/fragment.glsl"},{name:"skyboxShader",v:"./shaders/skybox/vertex.glsl",f:"./shaders/skybox/fragment.glsl"},{name:"africanTangent",v:"./shaders/african-tangent/vertex.glsl",f:"./shaders/african-tangent/fragment.glsl"},{name:"postproc",v:"./shaders/postprocess/vertex.glsl",f:"./shaders/postprocess/fragment.glsl"},{name:"floorlit",v:"./shaders/floor-lighted/vertex.glsl",f:"./shaders/floor-lighted/fragment.glsl"},{name:"light",v:"./shaders/light/vertex.glsl",f:"./shaders/light/fragment.glsl"},{name:"floor",v:"./shaders/floor/floor-vertex.glsl",f:"./shaders/floor/floor-fragment.glsl"},{name:"plaincube",v:"./shaders/plaincube/vertex.glsl",f:"./shaders/plaincube/fragment.glsl"},{name:"plaincube-pbr",v:"./shaders/plaincube-pbr/vertex.glsl",f:"./shaders/plaincube-pbr/fragment.glsl"},{name:"bloom-thresh",v:"./shaders/bloom-thresholding/vertex.glsl",f:"./shaders/bloom-thresholding/fragment.glsl"},{name:"gaussian-horizontal",v:"./shaders/gaussian-horizontal/vertex.glsl",f:"./shaders/gaussian-horizontal/fragment.glsl"},{name:"gaussian-vertical",v:"./shaders/gaussian-vertical/vertex.glsl",f:"./shaders/gaussian-vertical/fragment.glsl"},{name:"bloom-blend",v:"./shaders/bloom-blending/vertex.glsl",f:"./shaders/bloom-blending/fragment.glsl"},{name:"shadow-dir-depth",v:"./shaders/shadow-dir-depth/vertex.glsl",f:"./shaders/shadow-dir-depth/fragment.glsl"}];for(let t of n)w.getInstance().updateLoadingTip("Resources/Shader/"+t.name),e(yield r(t.name,t.v,t.f));const s=(e,r)=>S(this,void 0,void 0,(function*(){try{const n=yield v(r),s=function(t,e){const r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),r}(t,n);return this.textures.set(e,s),!0}catch(t){return!1}})),i=[{name:"tex1",path:"./african_diffuse.jpg"},{name:"tex2",path:"./african_specular.jpg"},{name:"tex3",path:"./star.jpg"},{name:"texFloor",path:"./floor.jpg"},{name:"texNorm",path:"./normal.jpg"},{name:"wall/diffuse",path:"./textures/wall/diffuse.jpg"}];for(let t of i)w.getInstance().updateLoadingTip("Resources/Texture/"+t.name),e(yield s(t.name,t.path))}))}}.getInstance(r);w.getInstance().updateLoadingTip("Preparing"),null==r.getExtension("EXT_color_buffer_float")&&alert("Floating buffer is not enabled / EXT_color_buffer_float"),r.viewport(0,0,window.innerWidth,window.innerHeight),r.disable(r.CULL_FACE),r.enable(r.STENCIL_TEST),r.stencilOp(r.KEEP,r.KEEP,r.REPLACE),r.stencilFunc(r.ALWAYS,1,255),r.stencilMask(255),t.registerInteractionEvent();const s=new R(r);yield s.loadTexFromFolder("./skybox/"),s.initBuffer();const i=p.create().setHdr(!0),o=new m(r,i),a=new m(r,i),h=new m(r,i),c=new m(r,i),u=new m(r,i),f=p.create().setHdr(!0).setScaler(4),l=new m(r,f);n.addTexture("tex3",o.tex),n.addTexture("bloom/input",u.tex),n.addTexture("bloom/gaussianH",a.tex),n.addTexture("bloom/gaussianV",h.tex),n.addTexture("bloom/blend",c.tex),n.addTexture("shadow/dir",l.tex),n.addTexture("texSky",s.cubeTex);const g=L.create(r),E=L.create(r),b=L.create(r),T=L.create(r),A=L.create(r),U=L.create(r),O=N.create(r).addDirectionalLight([0,-1,0],[25,25,25]),k=I.create(r).setAlbedo(1,0,0).setMetallic(1).setRoughness(.3).setAO(1),H=I.create(r).setAlbedo(1,1,1).setMetallic(1).setRoughness(.5).setAO(1),X=C.create(r).scale(.2).translate(1,1,3),V=B.create(r).addGeometry(X),Y=(P.create(r).setCamera(t).setShader(n.getShader("light")).setBuffer(V),D.create(r).setTex(n.getTexture("shadow/dir"))),W=C.create(r).scale(10).translate(0,-15,0),G=B.create(r).addGeometry(W),q=P.create(r).setCamera(t).setShader(n.getShader("plaincube-pbr")).setDepthShader(n.getShader("shadow-dir-depth")).setBuffer(G).setLight(O).setTexture(F.acmtDiffuse,Y).setMaterial(H);g.addObject(q);for(let e=0;e<15;e++){let e=3;const s=D.create(r).setTex(n.getTexture("shadow/dir")),i=C.create(r).scale(.5).rotateX(2*Math.random()*Math.PI).rotateY(2*Math.random()*Math.PI).rotateZ(2*Math.random()*Math.PI).translate(Math.random()*e*2-e,Math.random()*e*2-e,Math.random()*e*2-e),o=B.create(r).addGeometry(i),a=P.create(r).setCamera(t).setShader(n.getShader("plaincube-pbr")).setDepthShader(n.getShader("shadow-dir-depth")).setBuffer(o).setTexture(F.acmtDiffuse,s).setLight(O).setMaterial(k);g.addObject(a)}const z=D.create(r).setTex(n.getTexture("bloom/input")),J=M.create(r),K=B.create(r).addGeometry(J),Q=P.create(r).setCamera(t).setShader(n.getShader("postproc")).setBuffer(K).setTexture(F.acmtDiffuse,z);U.addObject(Q);const $=D.create(r).setTex(n.getTexture("tex3")),Z=M.create(r),tt=B.create(r).addGeometry(Z),et=P.create(r).setCamera(t).setShader(n.getShader("bloom-thresh")).setBuffer(tt).setTexture(F.acmtDiffuse,$);E.addObject(et);const rt=D.create(r).setTex(n.getTexture("bloom/gaussianH")),nt=M.create(r),st=B.create(r).addGeometry(nt),it=P.create(r).setCamera(t).setShader(n.getShader("gaussian-horizontal")).setBuffer(st).setTexture(F.acmtDiffuse,rt);b.addObject(it);const ot=D.create(r).setTex(n.getTexture("bloom/gaussianV")),at=M.create(r),ht=B.create(r).addGeometry(at),ct=P.create(r).setCamera(t).setShader(n.getShader("gaussian-vertical")).setBuffer(ht).setTexture(F.acmtDiffuse,ot);T.addObject(ct);const ut=D.create(r).setTex(n.getTexture("bloom/blend")),ft=D.create(r).setTex(n.getTexture("tex3")),lt=M.create(r),dt=B.create(r).addGeometry(lt),pt=P.create(r).setCamera(t).setShader(n.getShader("bloom-blend")).setBuffer(dt).setTexture(F.acmtDiffuse,ut).setTexture(F.acmtSpecular,ft);A.addObject(pt),w.getInstance().done(),requestAnimationFrame((function t(){l.bind(),j(r),g.renderLightDepthMapS(0),l.unbind(),o.bind(),j(r),g.render(),o.unbind(),a.bind(),j(r),E.render(),a.unbind(),h.bind(),j(r),b.render(),h.unbind(),c.bind(),j(r),T.render(),c.unbind(),A.render(),requestAnimationFrame(t)}))},new((r=void 0)||(r=Promise))((function(s,i){function o(t){try{h(n.next(t))}catch(t){i(t)}}function a(t){try{h(n.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))}()})()})();